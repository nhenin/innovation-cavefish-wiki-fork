## ğŸ§­ Summary

Work focused on completing the DemonstrateCommitment flow section and expanding commitment coverage. WBPS was modularized to support testing, while cooked-validator and cardano-api dependency sourcing were updated alongside Nix cleanup.
Build warnings were addressed across the stack as part of the integration work.
Circuit documentation captured VarLen hashing trade-offs and low-level Blake2b/Sha2 details, highlighting hashing as the primary ZK bottleneck.

While advancing the prototype and refining circuit inputs, we realized the circuit must compute `txId` internally to enable blind signing at the end of the WBPS protocol. This forces use of Cardano's Blake2b, which is poorly optimized for ZK circuits, and performance dropped sharply as we introduced real transaction sizes up to the 16 KiB body limit. We held design sessions to catalog optimization options and documented them for January decisions once most collaborators return from holidays.

## ğŸ¯ Goals

### [SRL 2 â†’ 3 | Single Service Provider Prototype](https://github.com/input-output-hk/innovation-cavefish/milestone/1)

- Complete the DemonstrateCommitment flow section with a nominal-case test.
- Expand commitment specs and test coverage in WBPS.
- Document ZK circuit hashing strategies and design trade-offs to guide optimization.
- Integrate dependency updates (cooked-validator, cardano-api) and keep builds clean.
- Remove stale Nix code and reduce warning noise.

## ğŸ›  Implementation Progress

### Backend & Prototype Logic
- Completed the DemonstrateCommitment flow section; prepared messages, scalars, and commitments are now wired in.
- Increased WBPS modularization to make testing more targeted.
- Integrated the new cooked-validator version and aligned cardano-api sourcing to support both test and production paths.

### Testing & CI
- Added commitment tests and Commitment.Scalars specs.
- Fixed warnings in WBPS and broader build warnings.

### Build & Tooling
- Removed irrelevant Nix code and merged build-warning fixes.

### ZK Circuits & Research
- Added a WBPS circuit-phase walkthrough and setup trade-off notes in `zkâ€SNARK-setups-and-circuit-designs.md`.
- Documented VarLen hashing strategies (O(N^2) black-box vs O(N) conditional state update), with Sha2/Blake2b padding details and VarLen Blake2b pseudocode.
- Flagged hashing as the dominant constraint cost (Blake2b compression ~99% of constraints; 16 KiB implies 128 compression rounds), and noted Halo2 lookup-table optimizations plus Midnight VarLen work as possible relief.


## ğŸ“„ Deliverables

### Commits (December 16â€“31, 2025)

* [f25c55c](https://github.com/input-output-hk/innovation-cavefish/commit/f25c55ce4692929d2aca237bdba9e4d2ada788da) â€” Merge pull request #97 from input-output-hk/nhenin/cooked-validator *(Nicolas Henin)*
* [31a9f9a](https://github.com/input-output-hk/innovation-cavefish/commit/31a9f9a10176becf5dc5d9e9c2849e8b26cb8a91) â€” updated cooked-validator dependencies *(Nicolas Henin)*
* [9360722](https://github.com/input-output-hk/innovation-cavefish/commit/9360722291de9e7d4d716a2a20c2ed2c91e43f16) â€” Added Kayvan's feedback *(Nicolas Henin)*
* [4dd3209](https://github.com/input-output-hk/innovation-cavefish/commit/4dd3209ae9c757a0ac11350f014c026638a141a0) â€” Added Commitment Tests *(Nicolas Henin)*
* [bd9c3e8](https://github.com/input-output-hk/innovation-cavefish/commit/bd9c3e8cfd0336f1f02e1972b681887ed3e006e6) â€” Added Commitment.Scalars.specs *(Nicolas Henin)*
* [46b1495](https://github.com/input-output-hk/innovation-cavefish/commit/46b14953d510a3a2fb87bf6f7b8e2261c6d5bd81) â€” fixed warnings *(Nicolas Henin)*
* [1a68c2a](https://github.com/input-output-hk/innovation-cavefish/commit/1a68c2a2ebf1bbdd9a64a9d440340dc13c6cf9e2) â€” integrated new cooked-validator version *(Nicolas Henin)*
* [9152ce2](https://github.com/input-output-hk/innovation-cavefish/commit/9152ce2c6e8373ac93e80ff160d5d6da44ff40dd) â€” Merge pull request #96 from input-output-hk/build/fix-warnings *(Nicolas Henin)*
* [79bc149](https://github.com/input-output-hk/innovation-cavefish/commit/79bc149899008fd471a6128a706527f280bf38fb) â€” Merge pull request #95 from input-output-hk/nix/remove-irrelevant-code *(Nicolas Henin)*
* [ec6a3a3](https://github.com/input-output-hk/innovation-cavefish/commit/ec6a3a3d50156e422a359a68553c5b28ab83c767) â€” fix- build warnings *(kayvank)*
* [484f293](https://github.com/input-output-hk/innovation-cavefish/commit/484f293f7596f4de15a2254a52ac12e42a3c9ea0) â€” get cardano-api from CHaP *(kayvank)*
* [4e5f766](https://github.com/input-output-hk/innovation-cavefish/commit/4e5f766711dcec6f00928ae96f95ec68c88dffeb) â€” nix-remove irrelevant code *(kayvank)*
* [6f99860](https://github.com/input-output-hk/innovation-cavefish/commit/6f99860b23e764a082f2cc5a5186910f1fb0fda6) â€” Merge pull request #93 from input-output-hk/nhenin/DemonstrateCommitment *(Nicolas Henin)*
* [df0b73d](https://github.com/input-output-hk/innovation-cavefish/commit/df0b73d2dfd400858f73b0f90e7940068835e79a) â€” increased modularization of WBPS package for testing purposes *(Nicolas Henin)*
* [737b3b8](https://github.com/input-output-hk/innovation-cavefish/commit/737b3b8eed99e7e974bcc01726856a0c23f9713f) â€” fixed warnings of wbps project *(Nicolas Henin)*
* [1a0823f](https://github.com/input-output-hk/innovation-cavefish/commit/1a0823f3cedcef791cb353428c4590b03b376576) â€” added Kayvan's feedback *(Nicolas Henin)*
* [5262848](https://github.com/input-output-hk/innovation-cavefish/commit/526284866b1cd678b8563e7b6a5e90936362155e) â€” Added Nominal Case for demonstrate a commitment *(Nicolas Henin)*

### Wiki Updates (December 16â€“31, 2025)

* [1a72939](https://github.com/input-output-hk/innovation-cavefish.wiki/commit/1a729393de07b250e805e493fcabfef20ac1bf5f) â€” Added Sha2 and Blake2b low-level details for VarLen and padding. Also added pseudo-code for VarLen Blake2b circuit. *(Daniel Morales)*
* [a8c1e70](https://github.com/input-output-hk/innovation-cavefish.wiki/commit/a8c1e70ef5ce79832f1e41fc929dda983237b80f) â€” Added high-level design steps for the circuit computation *(Daniel Morales)*
* [edc59f6](https://github.com/input-output-hk/innovation-cavefish.wiki/commit/edc59f6ac085f9e74569eddac8b114936b0cdde8) â€” Some refactor of VarLen problem and more specifics about hashing strategies *(Daniel Morales)*
* [71b321a](https://github.com/input-output-hk/innovation-cavefish.wiki/commit/71b321aa5e06e30561ef151ba84050a7c0be60f9) â€” Updated zkâ€SNARK setups and circuit designs (markdown) *(Nicolas Henin)*
* [956df31](https://github.com/input-output-hk/innovation-cavefish.wiki/commit/956df316f76ac1bbfd785a3c6e3ba2c1f48229a5) â€” Updated _Sidebar (markdown) *(Nicolas Henin)*
* [9a0b756](https://github.com/input-output-hk/innovation-cavefish.wiki/commit/9a0b7565a8073dcd16f5022b3556bcca290fc52f) â€” Updated Home (markdown) *(Nicolas Henin)*
* [3a6a5ce](https://github.com/input-output-hk/innovation-cavefish.wiki/commit/3a6a5ce31d4bffaacc50d98fe2512f9151a2b155) â€” Destroyed ğŸŸ  Computing `(x, X)` and `(r, R)` for WPBS (markdown) *(Nicolas Henin)*
* [8f541d4](https://github.com/input-output-hk/innovation-cavefish.wiki/commit/8f541d4c1a9c12a5b4e7e8cb6f7abc3768a1ea82) â€” Included link to zk-SNARK wiki page. *(Daniel Morales)*
* [e7874eb](https://github.com/input-output-hk/innovation-cavefish.wiki/commit/e7874eb5253e438f17ff913aaa3aa14c3d81e776) â€” High-level details about the types of setups in zk-SNARKs and their implications in the circuit design. *(Daniel Morales)*
* [f0b88d7](https://github.com/input-output-hk/innovation-cavefish.wiki/commit/f0b88d7ab45657148845269b541b49bb48b266d4) â€” Updated Home (markdown) *(Nicolas Henin)*
* [7990cda](https://github.com/input-output-hk/innovation-cavefish.wiki/commit/7990cda9920fae6b58124dce81ed87bec15f6fdd) â€” Updated Home (markdown) *(Nicolas Henin)*
* [4db1716](https://github.com/input-output-hk/innovation-cavefish.wiki/commit/4db1716fa7035e78e6d90dd42944a79af75c94ea) â€” Reports updated *(Nicolas Henin)*

### Issues (December 16â€“31, 2025)

#### Closed
* [#59](https://github.com/input-output-hk/cavefish/issues/59) â€” ğŸ£ 2. User Generates Intent â†’ SP Produces Transaction
* [#60](https://github.com/input-output-hk/cavefish/issues/60) â€” ğŸ£ 3. SP Produces Commitment â†’ Sent to User
* [#67](https://github.com/input-output-hk/cavefish/issues/67) â€” 2. [cavefish-server] Intent DSL interpreter (Cardano Transaction Builder)
* [#68](https://github.com/input-output-hk/cavefish/issues/68) â€” 1. [cavefish-core] Intent DSL
* [#69](https://github.com/input-output-hk/cavefish/issues/69) â€” 3. [cavefish-server] Endpoint: POST /intent/solve
* [#70](https://github.com/input-output-hk/cavefish/issues/70) â€” 4. [web-page] UI for creating intents + call to server
* [#74](https://github.com/input-output-hk/cavefish/issues/74) â€” Structured logging

#### Updated
* [#59](https://github.com/input-output-hk/cavefish/issues/59) â€” ğŸ£ 2. User Generates Intent â†’ SP Produces Transaction
* [#60](https://github.com/input-output-hk/cavefish/issues/60) â€” ğŸ£ 3. SP Produces Commitment â†’ Sent to User
* [#67](https://github.com/input-output-hk/cavefish/issues/67) â€” 2. [cavefish-server] Intent DSL interpreter (Cardano Transaction Builder)
* [#68](https://github.com/input-output-hk/cavefish/issues/68) â€” 1. [cavefish-core] Intent DSL
* [#69](https://github.com/input-output-hk/cavefish/issues/69) â€” 3. [cavefish-server] Endpoint: POST /intent/solve
* [#70](https://github.com/input-output-hk/cavefish/issues/70) â€” 4. [web-page] UI for creating intents + call to server
* [#74](https://github.com/input-output-hk/cavefish/issues/74) â€” Structured logging
